# 230308

- [[ìœ ë‹ˆí‹° ê°•ì¢Œ] ë‹¨ê°„ë¡ íŒŒë¥¼ ìœ ë‹ˆí‹°ë¡œ êµ¬í˜„í•˜ê¸° Part 14 - 3 ì”¬ ì´ë™ ì—°ì¶œ](https://youtu.be/RpSp-zgm5ZE?list=PLUZ5gNInsv_NG_UKZoua8goQbtseAo8Ow)
- [[ìœ ë‹ˆí‹° ê°•ì¢Œ] ë‹¨ê°„ë¡ íŒŒë¥¼ ìœ ë‹ˆí‹°ë¡œ êµ¬í˜„í•˜ê¸° Part 14 - 2 ìŠ¤í° ìœ„ì¹˜ ì„¤ì •](https://youtu.be/z4kYoY9DWH4?list=PLUZ5gNInsv_NG_UKZoua8goQbtseAo8Ow)



## 1. ì—°ì† ì´ë²¤íŠ¸ ë°œìƒ ì‹œ UI ë³´ì´ëŠ” ë¬¸ì œ í•´ê²°

- ğŸ“‘ **`DialogueManager.cs` ìˆ˜ì •**

- `EndDialogue()` ì½”ë£¨í‹´ ìˆ˜ì •

  ```c#
  IEnumerator EndDialogue()
  {
      // ...
  
      // ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ìˆìœ¼ë©´, UIë¥¼ í‘œì‹œí•˜ì§€ ì•Šê³  clickedInteractive ë³€ìˆ˜ë§Œ falseë¡œ
      if (go_nextEvent != null)
      {
          InteractionController.clickedInteractive = false;
      }
  
      // ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´, UIë¥¼ í‘œì‹œí•˜ê³  clickedInteractive ë³€ìˆ˜ë„ falseë¡œ
      else
      {
          theInteractionController.SettingUI(true); // ì»¤ì„œ, ìƒíƒœì°½ ë³´ì´ê¸°
      }
  
      SettingUI(false);   // ëŒ€ì‚¬ì°½, ì´ë¦„ì°½ ìˆ¨ê¸°ê¸°
  
      // ëª¨ë“  ëŒ€í™”ê°€ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„, ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ìˆìœ¼ë©´ ì‹¤í–‰
      yield return new WaitUntil(() => !InteractionController.clickedInteractive);
  
      if (go_nextEvent != null)
      {
          go_nextEvent.SetActive(true);
          go_nextEvent = null;
      }
  }
  ```

  - ëŒ€í™”ê°€ ëë‚˜ë©´ `InteractionController`ì˜ `SettingUI(true)` í•¨ìˆ˜ë¥¼ ë¬´ì¡°ê±´ í˜¸ì¶œí–ˆë˜ ë¶€ë¶„ì„ ë¶„ê¸° ì²˜ë¦¬í•´ ì¤€ë‹¤.
    - ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ìˆìœ¼ë©´ UIë¥¼ í‘œì‹œí•˜ì§€ ì•Šê³ , `clickedInteractive`ë¥¼ falseë¡œ í•´ì„œ, ë‹¤ìŒ ì´ë²¤íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
    - ë‹¤ìŒ ì´ë²¤íŠ¸ê°€ ì—†ìœ¼ë©´ UIë¥¼ í‘œì‹œí•˜ê³ , `clickedInteractive`ë¥¼ falseë¡œ ë˜ëŒë¦°ë‹¤.



- ì‹¤í–‰ ê²°ê³¼

  ![2023-03-08_20-28-05](Assets/230308.assets/2023-03-08_20-28-05.gif)



## 2. ë§µ ì´ë™ ì—°ì¶œ

- ë§µì„ ì´ë™í•  ë•Œ, í˜ì´ë“œì¸/ì•„ì›ƒ íš¨ê³¼ë¥¼ ì¶”ê°€
- ì‹ ì´ ì „í™˜ë  ë•Œ, UIê°€ ì‚¬ë¼ì¡Œë‹¤ê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ëŠ” ì—°ì¶œì„ êµ¬í˜„í•´ë³´ì.
  - ì–´ëŠ ì‹ ìœ¼ë¡œ ì „í™˜ë˜ì–´ë„ UIëŠ” íŒŒê´´ë˜ì–´ì„  X
  - UIë¥¼ íŒŒê´´ì‹œí‚¤ì§€ ì•ŠëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ë³´ì.



### 1. ì‹  ì „í™˜ ì‹œ UI íŒŒê´´ë˜ì§€ ì•Šë„ë¡ êµ¬í˜„

- Scripts í´ë”ì— etc í´ë”ë¥¼ ìƒì„±í•˜ê³ , `DontDestroy.cs` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í•˜ì˜€ë‹¤.

- ğŸ“‘ **`DontDestroy.cs` ìƒì„±**

- ë³€ìˆ˜

  ```c#
  public static DontDestroy instance;
  ```



- `Awake()` í•¨ìˆ˜ ìƒì„±

  ```c#
  private void Awake()
  {
      if (instance == null)
      {
          instance = this;
          DontDestroyOnLoad(gameObject);
      }
  
      else
      {
          Destroy(gameObject);
      }
  }
  ```

  - `DontDestroy` ì¸ìŠ¤í„´ìŠ¤(UI)ê°€ ì—†ìœ¼ë©´, ì¸ìŠ¤í„´ìŠ¤ì— ìê¸° ìì‹ (UI)ì„ ì§‘ì–´ë„£ê³ , ìê¸° ìì‹ ì´ íŒŒê´´ë˜ì§€ ì•Šê²Œ í•œë‹¤.
  - ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ íŒŒê´´í•œë‹¤.



- `Game Canvas` ì˜¤ë¸Œì íŠ¸ì— `Dont Destroy` ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶”ê°€í•œë‹¤.

  ![image-20230309195737274](Assets/230308.assets/image-20230309195737274.png)



- ì‹¤í–‰ ê²°ê³¼

  ![Honeycam_2023-03-09_19-59-07](Assets/230308.assets/Honeycam_2023-03-09_19-59-07.gif)

  - ë§µì„ ì´ë™í–ˆë”ë‹ˆ UIê°€ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ë‹¤.
  - ì»¤ì„œ ì´ë¯¸ì§€ê°€ ì›ë˜ ìƒíƒœë¡œ ë˜ëŒì•„ ê°€ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ë‹¤.



### 2. ì‹  ì „í™˜ ì‹œ í˜ì´ë“œì¸/ì•„ì›ƒ íš¨ê³¼

- ğŸ“‘ **`TransferManager.cs` ìˆ˜ì •**

- ë³€ìˆ˜

  ```c#
  SplashManager theSplashManager; // í˜ì´ë“œì¸/ì•„ì›ƒ
  InteractionController theIC;    // UI í‘œì‹œ
  ```



- `Start()` í•¨ìˆ˜ ìƒì„±

  ```c#
  private void Start()
  {
      theSplashManager = FindObjectOfType<SplashManager>();
      theIC = FindObjectOfType<InteractionController>();
  }
  ```



- `Transfer()` ì½”ë£¨í‹´ ìˆ˜ì •

  ```c#
  public IEnumerator Transfer(string p_sceneName, string p_locationName)
  {
      theIC.SettingUI(false); // UI ìˆ¨ê¸°ê¸°
  
      // í˜ì´ë“œì•„ì›ƒ
      SplashManager.isFinished = false;
      StartCoroutine(theSplashManager.FadeOut(false, true));
      yield return new WaitUntil(() => SplashManager.isFinished);
  
      // ì‹  ì „í™˜
      SceneManager.LoadScene(p_sceneName);
  }
  ```

  - ì‹ ì´ ì „í™˜ë  ë•Œ, UIê°€ ì‚¬ë¼ì§€ê³  í˜ì´ë“œì•„ì›ƒëœë‹¤.



- `TransferDone()` ì½”ë£¨í‹´ ìƒì„±

  ```c#
  // ë§µ ì´ë™ ì™„ë£Œ
  public IEnumerator TransferDone()
  {
      // í˜ì´ë“œì¸
      SplashManager.isFinished = false;
      StartCoroutine(theSplashManager.FadeIn(false, true));
      yield return new WaitUntil(() => SplashManager.isFinished);
  
      theIC.SettingUI(true);	// UI ë³´ì´ê¸°
  }
  ```

  

- ê·¸ëŸ°ë° ì´ë™ì´ ì™„ë£Œë˜ì—ˆì„ ë•Œ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” `TransferDone()`ë¥¼ ì–¸ì œ í˜¸ì¶œí•´ì•¼í• ì§€ ëª¨ë¥¸ë‹¤.

- ë”°ë¼ì„œ ì‹  ì „í™˜ì´ ì™„ë£Œë˜ì—ˆì„ ë•Œë¥¼ ì•Œë ¤ì£¼ì–´ì•¼ í•œë‹¤.

- ğŸ“‘ **`TransferSpawnManager.cs` ìƒì„±**

- ë³€ìˆ˜

  ```c#
  public static bool isSpawnTiming = false;	// ìŠ¤í°í•´ë„ ë˜ëŠ”ì§€ ì—¬ë¶€
  ```



- ğŸ“‘ **`TransferManager.cs` ìˆ˜ì •**

- `Transfer()` ì½”ë£¨í‹´ ìˆ˜ì •

  ```c#
  public IEnumerator Transfer(string p_sceneName, string p_locationName)
  {
      // ...
  
      // ì‹  ì „í™˜
      TransferSpawnManager.isSpawnTiming = true;
      SceneManager.LoadScene(p_sceneName);
  }
  ```

  - `isSpawnTiming`ì„ trueë¡œ ë°”ê¿”ì¤€ í›„, ì‹ ì„ ì „í™˜í•œë‹¤.



- ğŸ“‘ **`TransferSpawnManager.cs` ìˆ˜ì •**

- `Start()` í•¨ìˆ˜

  ```c#
  void Start()
  {
      if (isSpawnTiming)
      {
          TransferManager theTM = FindObjectOfType<TransferManager>();
  
          isSpawnTiming = false;
          StartCoroutine(theTM.TransferDone());
      }
  }
  ```



- `Corridor` ì‹ ì— ë¹ˆ ì˜¤ë¸Œì íŠ¸ `Corridor`ë¥¼ ë§Œë“¤ì–´ì¤€ í›„, ê±°ê¸°ì— `Transform Spawn Manager` ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶”ê°€í•œë‹¤.

  ![image-20230310200548290](Assets/230308.assets/image-20230310200548290.png)



### 3. ì‹ ì´ ì „í™˜ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë‹¤...ğŸ¤’ğŸ¤¯ğŸ¤•

- ê·¸ëŸ°ë° ì´ë ‡ê²Œ í•˜ë©´ ë  ì¤„ ì•Œì•˜ìœ¼ë‚˜... í˜ì´ë“œ íš¨ê³¼ë¥¼ ë„£ìë§ˆì ë‹¤ìŒ ì‹ ìœ¼ë¡œ ì „í™˜ì´ ë˜ì§€ ì•Šì•˜ë‹¤.
- `Transfer()` ì½”ë£¨í‹´ì˜ `yield return new WaitUntil(() => SplashManager.isFinished);` êµ¬ë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ì§€ ì•ŠëŠ” ë¬¸ì œ...
- ê·¸ë˜ì„œ ë””ë²„ê¹… í•´ë³´ì•˜ë”ë‹ˆ `DialogueManager.cs`ì™€ `MainMenu.cs`ì™€ `InteractionEvent.cs`ì˜ `Update()` í•¨ìˆ˜ë¥¼ ê³„ì† ì™”ë‹¤ê°”ë‹¤ í•˜ê³  ìˆì—ˆë‹¤...
  - Game Canvasì— `Main Menu` ì»´í¬ë„ŒíŠ¸ ìˆê¸¸ë˜ ì‚­ì œí•¨..
- `theIC.settingUI(false);` ë’¤ì— yield êµ¬ë¬¸ì„ ë‘ì—ˆë”ë‹ˆ, ì”¬ì´ ì „í™˜ë˜ì§€ ì•Šì•˜ë‹¤. `theIC.settingUI(false);`ë¥¼ ì§€ìš°ë‹ˆ ì‹ ì´ ì „í™˜ë˜ì—ˆë‹¤.



- `Interaction Controller`ì˜ `SettingUI(false)`ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì´, ì‹  ì „í™˜ì´ ì•ˆ ë˜ëŠ” ê²ƒê³¼ ë¬´ìŠ¨ ìƒê´€ì´ ìˆì„ê¹Œ...
- `SettingUI(true)`ëŠ” ë˜ ê´œì°®ì€ ê±¸ ë³´ë©´, ê²Œì„ ì˜¤ë¸Œì íŠ¸ê°€ ë¹„í™œì„±í™” ë˜ëŠ” ê²ƒê³¼ ì—°ê´€ì´ ìˆì–´ ë³´ì¸ë‹¤.



### 4. ì‹  ì „í™˜ ì˜¤ë¥˜ í•´ê²°

- ë¬¸ì œ ì½”ë“œ

  ```c#
  // TransferManager.cs
  
  public IEnumerator Transfer(string p_sceneName, string p_locationName)
  {
      theIC.SettingUI(false); // ì´ ë¶€ë¶„ì—ì„œ ì‘ë™ âŒ
  
      // ...
  }
  ```

  - `theIC.SettingUI(false);` êµ¬ë¬¸ë§Œ ë„£ìœ¼ë©´ ë‹¤ìŒ ì‹ ìœ¼ë¡œ ì „í™˜ì´ ë˜ì§€ ì•Šì•˜ë‹¤.

  - í•¨ìˆ˜ ì¸ìë¡œ `true`ë¥¼ ì£¼ë©´ ì •ìƒ ì‘ë™í•˜ì˜€ë‹¤.

  - ê·¸ëŸ¬ë©´ UIë¥¼ ë¹„í™œì„±í™”í•˜ëŠ” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ìƒê²¼ê² êµ¬ë‚˜!




- ì›ì¸
  - [Load Scene with Coroutine](https://forum.unity.com/threads/load-scene-with-coroutine.702677/)
  - ì—¬ê¸° ë‹µë³€ì„ ë³´ê³  ì„¤ë§ˆ...? í–ˆëŠ”ë° ì§„ì§œì˜€ë‹¤...
  -  `Interaction Controller`ê°€ `UI_Cursor` ì˜¤ë¸Œì íŠ¸ì˜ ì»´í¬ë„ŒíŠ¸ì˜€ê¸° ë•Œë¬¸ì—, `Transfer()` ì½”ë£¨í‹´ì—ì„œ `UI_Cursor`ë¥¼ ë¹„í™œì„±í™”í•˜ëŠ” `theIC.SettingUI(false)`ë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ `Interaction Controller`ë„ ë¹„í™œì„±í™”ë˜ì—ˆê¸° ë•Œë¬¸ì— ì‹ ì„ ì „í™˜í•˜ì§€ ëª»í–ˆë˜ ê²ƒì´ì—ˆë‹¤..



- í•´ê²°

  - ê·¸ë˜ì„œ `Controller` ì˜¤ë¸Œì íŠ¸ë¥¼ ë§Œë“  í›„, `Interaction Controller` ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜®ê²¨ì£¼ì—ˆë‹¤.

    ![image-20230310195726161](Assets/230308.assets/image-20230310195726161.png)

    

  - ì‹ ì´ ì „í™˜ë˜ë©´ì„œ `Interaction Controller`ì— ë„£ì–´ì£¼ì—ˆë˜ ì¹´ë©”ë¼ ì •ë³´ê°€ ì†Œì‹¤ë˜ê³ , ì˜¤ë¥˜ë¥¼ ì¼ìœ¼ì¼œì„œ ì•„ì˜ˆ ê·¸ ì‹ ì˜ ë©”ì¸ ì¹´ë©”ë¼ë¥¼ ë„£ì–´ì£¼ë„ë¡ ì½”ë“œë¥¼ ë³€ê²½í•´ì£¼ì—ˆë‹¤.

    ```c#
    void CheckObject()
    {
        // Vector2 pos = cam.ScreenToWorldPoint(Input.mousePosition);
    	Vector2 pos = Camera.main.ScreenToWorldPoint(Input.mousePosition);
        
        // ...
    }
    ```

    

  - ì‹ ì´ ì „í™˜ë˜ë©´ì„œ `Manager` ì˜¤ë¸Œì íŠ¸ê°€ íŒŒê´´ë˜ì§€ ì•Šë„ë¡, `TransferManager.cs`ì— `Awake()` í•¨ìˆ˜ë¥¼ ìƒì„±í•œ í›„, ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.

    ```c#
    public static TransferManager Instance;
    
    private void Awake()
    {
        if (Instance == null)
        {
            Instance = this;
            DontDestroyOnLoad(gameObject);
        }
    
        else
        {
            Destroy(gameObject);
        }
    }
    ```



- ì‹¤í–‰ ê²°ê³¼

  ![Honeycam_2023-03-10_20-00-47](Assets/230308.assets/Honeycam_2023-03-10_20-00-47.gif)

  - ì»´í“¨í„°ë¥¼ êµì²´í–ˆë”ë‹ˆ ê¸°ì¡´ í˜ì´ë“œì¸/ì•„ì›ƒ íš¨ê³¼ê°€ ë„ˆë¬´ ë¹¨ë¦¬ ëë‚˜ê¸¸ë˜, `Splash Manager`ì˜ `Fade Speed`ë¥¼ 0.005ë¡œ, `Fade Slow Speed`ë¥¼ 0.001ë¡œ ë³€ê²½í•˜ì˜€ë‹¤.
  - UIë„ ì˜ ì‚¬ë¼ì§€ê³ , ì‹  ì „í™˜ë„ ì˜ ë˜ê³ , UIê°€ ë‹¤ì‹œ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒë„ ì˜ ëœë‹¤!
  - í•˜ì§€ë§Œ ì•„ì§ ì»¤ì„œ ì´ë¯¸ì§€ê°€ ë˜ëŒì•„ ì˜¤ì§€ ì•ŠëŠ” ë¬¸ì œëŠ” ê·¸ëŒ€ë¡œì´ë‹¤.



### 5. ì»¤ì„œ ì´ë¯¸ì§€ ì˜¤ë¥˜ í•´ê²°

- `Controller` ì˜¤ë¸Œì íŠ¸ë„ ì‹ ì´ ì „í™˜ë  ë•Œ íŒŒê´´ë˜ë©´ ì•ˆ ëœë‹¤.

- ë”°ë¼ì„œ `InteractionController.cs`ì— `Awake()` í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´, ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•´ ì¤€ë‹¤.

  ```c#
  public static InteractionController Instance;
  
  private void Awake()
  {
      if (Instance == null)
      {
          Instance = this;
          DontDestroyOnLoad(gameObject);
      }
  
      else
      {
          Destroy(gameObject);
      }
  }
  ```



- ì‹¤í–‰ ê²°ê³¼

  ![Honeycam_2023-03-10_20-18-39](Assets/230308.assets/Honeycam_2023-03-10_20-18-39.gif)

  - ì»¤ì„œì˜ ëª¨ìŠµì´ ì œëŒ€ë¡œ ëŒì•„ì™”ë‹¤.
  - ì™„ë²½!!



## 3. ë‹¤ìŒì— í•  ì¼

- ~~ì´ë²¤íŠ¸ ì—°ì†ìœ¼ë¡œ ë°œìƒì‹œí‚¤ê¸°~~
- ~~ë§µ ì´ë™ êµ¬í˜„í•´ë³´ê¸°~~
- ~~ìë™ ì´ë²¤íŠ¸ ì‹œ UI ë…¸ì¶œë˜ëŠ” í˜„ìƒ ìˆ˜ì •~~
- ì‹  ì „í™˜ í›„ ìë™ ì´ë²¤íŠ¸
- ì‚¬ìš´ë“œ ê´€ë ¨ ê¸°ëŠ¥ë“¤ êµ¬í˜„í•´ë³´ê¸° (íš¨ê³¼ìŒ, ë³´ì´ìŠ¤, ë°°ê²½ ìŒì•…)
- ì˜¤ë¸Œì íŠ¸ í´ë¡œì¦ˆì—…(í•˜ë©´ì„œ í™”ë©´ ì´ë™)í•˜ê¸°??
- ë§ˆìš°ìŠ¤ ì»¤ì„œì— ì• ë‹ˆë©”ì´ì…˜? ë„£ê¸°
- ë§ˆìš°ìŠ¤ ì»¤ì„œì— ì´í™íŠ¸ ë„£ê¸°
- ì˜¤ë¸Œì íŠ¸ íšë“ ë° í™œìš©
- í•œ ë²ˆë§Œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ êµ¬í˜„
- **ì˜¤ë¸Œì íŠ¸ í´ë¦­ ì‹œ, ê°•ì¡°í•˜ëŠ” ì´í™íŠ¸ ë„£ê¸° & ì½”ë£¨í‹´ìœ¼ë¡œ ëŒ€ì‚¬ì°½ ë„ìš°ëŠ” ì‹œê°„ ì¡°ì •í•˜ê¸°**



## 4. í›„ê¸°

- ì˜ìƒ ë‘˜ ëª¨ë‘ ì–´ë µì§„ ì•Šì•˜ëŠ”ë°, ì¤‘ê°„ì— ì´ìƒí•œ ì˜¤ë¥˜ê°€ ë‚˜ì„œ ì´í‹€ ë™ì•ˆ ê³ ì¹˜ëŠë¼ ë¨¸ë¦¬ê°€ ë„ˆë¬´ ì•„íŒ ë‹¤... ì˜ˆì „ì— ì•± í”„ë¡œê·¸ë˜ë° íŒ€í”Œí–ˆì„ ë•Œ DBì— ì‚¬ì§„ ë„£ëŠ”ë‹¤ê³  3ì¼ ë™ì•ˆ ê³ ìƒí–ˆë˜ ì¼ì´ ìƒê°ë‚¬ë‹¤.

- ì´ë²ˆì—ì•¼ë§ë¡œ ë‹µì´ ì—†ëŠ” ê±´ê°€ ìƒê°í–ˆëŠ”ë°, ê·¸ë˜ë„ ì˜¤ë¥˜ í•´ê²°ì— ëŒ€í•œ íŒíŠ¸ë¥¼ ì°¾ì•„ì„œ ë‹¤í–‰ì´ì—ˆë‹¤. ì´ëŒ€ë¡œë§Œ ê°€ì... íŒŒì´íŒ…!!